@import "tailwindcss";

@variant dark (&:where([data-theme="dark"], [data-theme="dark"] *));

/* Tailwind v4 Theme - Custom tokens */
@theme {
  /* ========================================
   * EPIC 2: COLOR SYSTEM INTEGRATION
   * Maps CSS variables to Tailwind utilities
   * ======================================== */

  /* Surface Colors */
  --color-surface-1: var(--color-surface-1);
  --color-surface-2: var(--color-surface-2);
  --color-surface-3: var(--color-surface-3);
  --color-surface-overlay: var(--color-surface-overlay);
  --color-surface-hover: var(--color-surface-hover);
  --color-surface-active: var(--color-surface-active);

  /* Text Colors */
  --color-text-primary: var(--color-text-primary);
  --color-text-secondary: var(--color-text-secondary);
  --color-text-assistant: var(--color-text-assistant);
  --color-text-user: var(--color-text-user);
  --color-text-on-surface: var(--color-text-on-surface);

  /* Border Colors */
  --color-border-primary: var(--color-border-primary);
  --color-border-secondary: var(--color-border-secondary);
  --color-border-focus: var(--color-border-focus);
  --color-border-hover: var(--color-border-hover);

  /* Brand Colors */
  --color-brand-primary: var(--color-brand-primary);
  --color-brand-secondary: var(--color-brand-secondary);

  /* Status Colors */
  --color-status-info: var(--color-status-info);
  --color-status-success: var(--color-status-success);
  --color-status-warning: var(--color-status-warning);
  --color-status-error: var(--color-status-error);

  /* Keyframe animations that Tailwind doesn't provide */
  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes typing {
    0%,
    60%,
    100% {
      opacity: 0.3;
    }
    30% {
      opacity: 1;
    }
  }

  @keyframes fadeOut {
    0% {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
    100% {
      opacity: 0;
      transform: translateY(-8px) scale(0.95);
    }
  }

  @keyframes toast-pulse {
    0%,
    100% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.05);
    }
  }
}

/* Essential custom CSS - Platform-specific features and complex patterns */
@layer components {
  /* ==========================================
   * PLATFORM-SPECIFIC: macOS window dragging
   * ========================================== */
  .macos-drag-handle {
    -webkit-app-region: drag;
    position: fixed;
    top: 0;
    left: 260px;  /* Exclude sidebar when expanded */
    right: 420px; /* Exclude file panel when expanded */
    height: 32px;
    z-index: 10000;
    background: transparent;
    pointer-events: auto;
  }

  /* Extend drag handle when sidebar is collapsed */
  body:has(#sidebar.collapsed) .macos-drag-handle {
    left: 0;
  }

  /* Extend drag handle when file panel is collapsed */
  body:has(#files-panel.collapsed) .macos-drag-handle {
    right: 0;
  }

  body:has(.custom-titlebar) .macos-drag-handle {
    display: none;
  }

  #sidebar-toggle,
  #open-files-btn,
  #files-panel > div:first-child {
    -webkit-app-region: no-drag;
    position: relative;
    z-index: 10001;
  }

  /* ==========================================
   * PLATFORM-SPECIFIC: Custom titlebar (Windows/Linux)
   * ========================================== */
  .custom-titlebar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 32px;
    background: #ffffff;
    display: flex;
    align-items: center;
    justify-content: space-between;
    user-select: none;
    z-index: 10000;
    border-bottom: 1px solid #e5e7eb;
    transition:
      background-color 0.2s,
      border-color 0.2s;
  }

  .dark .custom-titlebar {
    background: #191b29;
    border-bottom-color: #4f5663;
  }

  .titlebar-drag-region {
    -webkit-app-region: drag;
    flex: 1;
    height: 100%;
    display: flex;
    align-items: center;
    padding-left: 12px;
  }

  .titlebar-title {
    font-size: 13px;
    font-weight: 500;
    color: #4f5663;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  }

  .dark .titlebar-title {
    color: #d1d5db;
  }

  .titlebar-controls {
    -webkit-app-region: no-drag;
    display: flex;
    height: 100%;
  }

  .titlebar-button {
    width: 46px;
    height: 100%;
    border: none;
    background: transparent;
    color: #5a5f68;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition:
      background-color 0.15s,
      color 0.15s;
    padding: 0;
    margin: 0;
  }

  .dark .titlebar-button {
    color: #9ca3af;
  }

  .titlebar-button:hover {
    background: #f3f4f6;
    color: #191b29;
  }

  .dark .titlebar-button:hover {
    background: #4f5663;
    color: #f9fafb;
  }

  .titlebar-close:hover {
    background: #dc2626;
    color: #ffffff;
  }

  .dark .titlebar-close:hover {
    background: #dc2626;
    color: #ffffff;
  }

  .titlebar-button svg {
    width: 10px;
    height: 10px;
  }

  body:has(.custom-titlebar) {
    padding-top: 32px;
  }

  /* ==========================================
   * PANEL ALIGNMENT: Ensure full-height panels align properly
   * Both session panel (sidebar) and file panel extend full height
   * and need to account for custom titlebar on Windows/Linux
   * ========================================== */

  /* Session panel first button - push down to account for titlebar */
  body:has(.custom-titlebar) #sidebar > button:first-of-type {
    margin-top: 44px; /* 32px titlebar + 12px original margin */
  }

  /* File panel header - push down to account for titlebar on Windows/Linux */
  body:has(.custom-titlebar) #files-panel > div:first-child {
    margin-top: 32px; /* Account for custom titlebar */
  }

  /* ==========================================
   * CUSTOM SCROLLBARS (not available in Tailwind)
   * ========================================== */
  .custom-scrollbar::-webkit-scrollbar {
    width: 8px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: var(--color-scrollbar-thumb);
    border-radius: 0.25rem;
  }


  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background-color: var(--color-scrollbar-thumb-hover);
  }

  /* Firefox scrollbar styling */
  .custom-scrollbar {
    scrollbar-color: var(--color-scrollbar-thumb) transparent;
    scrollbar-width: thin;
  }

  .sessions-scrollbar::-webkit-scrollbar {
    width: 6px;
  }

  .sessions-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .sessions-scrollbar::-webkit-scrollbar-thumb {
    background-color: var(--color-scrollbar-thumb);
    border-radius: 0.125rem;
  }


  .sessions-scrollbar::-webkit-scrollbar-thumb:hover {
    background-color: var(--color-scrollbar-thumb-hover);
  }

  /* Firefox scrollbar styling */
  .sessions-scrollbar {
    scrollbar-color: var(--color-scrollbar-thumb) transparent;
    scrollbar-width: thin;
  }

  /* ==========================================
   * DYNAMICALLY CREATED COMPONENTS
   * Minimal classes for JavaScript-generated elements
   * ========================================== */

  /* Session items in sidebar */
  .session-item {
    @apply p-3 mb-1 rounded-lg cursor-pointer text-sm transition-colors flex items-center justify-between gap-2;
    color: var(--color-text-primary);
    background-color: transparent;
  }

  .session-item:hover {
    background-color: var(--color-surface-hover);
  }

  .session-item.active {
    background-color: var(--color-brand-primary);
    color: var(--color-text-user);
  }

  .session-title {
    @apply overflow-hidden text-ellipsis whitespace-nowrap;
    max-width: 180px; /* Less aggressive truncation */
  }

  .session-content {
    @apply flex-1 min-w-0 flex flex-col;
  }

  .session-timestamp {
    @apply text-xs mt-0.5;
  }

  .session-actions {
    @apply flex gap-1 opacity-0 transition-opacity duration-200 flex-shrink-0;
  }

  .session-item:hover .session-actions {
    @apply opacity-100;
  }

  .session-action-btn {
    @apply bg-transparent border-none cursor-pointer p-1.5 rounded inline-flex items-center justify-center;
  }

  .session-action-btn svg {
    @apply transition-colors duration-150;
  }

  /* Summarize button - Blue hover */
  .session-action-btn.summarize-btn:hover svg {
    color: var(--color-status-info);
    @apply stroke-current;
  }

  /* Rename button - Green hover */
  .session-action-btn.rename-btn:hover svg {
    color: var(--color-status-success);
    @apply stroke-current;
  }

  /* Delete button - Red hover */
  .session-action-btn.delete-btn:hover svg {
    color: var(--color-status-error);
    @apply stroke-current;
  }

  .session-title-edit {
    font-family: inherit;
    background: var(--color-surface-3);
    color: var(--color-text-primary);
    border-color: var(--color-brand-primary);
  }

  .load-more-sessions-btn {
    @apply w-full py-2.5 px-3 mt-2 bg-transparent rounded-lg text-[13px] font-medium cursor-pointer transition-all text-center disabled:opacity-50 disabled:cursor-not-allowed;
    border: 1px solid var(--color-border-secondary);
    color: var(--color-text-primary);
  }

  .load-more-sessions-btn:hover {
    background-color: var(--color-surface-hover);
    border-color: var(--color-brand-primary);
    color: var(--color-brand-primary);
  }

  /* Empty session list state */
  .session-list-empty {
    @apply flex flex-col items-center justify-center py-12 px-4 text-center;
  }

  .empty-icon {
    @apply mb-3;
    color: var(--color-text-secondary);
  }

  .empty-message {
    @apply text-sm;
    color: var(--color-text-secondary);
  }

  /* Function call cards */
  .function-call-card {
    @apply block border rounded-md px-2.5 py-1.5 my-1 text-xs cursor-pointer transition-all;
    background: var(--color-surface-overlay);
    border-color: var(--color-border-secondary);
    animation: slideIn 0.3s ease-out;
  }

  .function-call-card:hover {
    background: var(--color-surface-hover);
    border-color: var(--color-border-primary);
  }

  .function-call-card.expanded {
    @apply block cursor-default p-3.5 px-4 my-1.5 rounded-lg max-w-full;
    background: var(--color-surface-1);
    border: 1px solid var(--color-border-secondary);
  }

  .function-call-card.expanded:hover {
    background: var(--color-surface-1);
    border-color: var(--color-border-secondary);
    transform: none;
  }

  .function-call-card.executing {
    @apply text-white border-indigo-400/40;
    background: var(--color-function-executing);
    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
  }

  .function-call-card.success {
    @apply text-white border-emerald-500/40;
    background: var(--color-function-success);
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
  }

  .function-call-card.error {
    @apply text-white border-red-500/40;
    background: var(--color-function-error);
    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
  }

  .function-header {
    @apply flex items-center gap-2 mb-0;
  }

  .function-call-card.expanded .function-header {
    @apply gap-2 mb-2.5;
  }

  .function-icon {
    @apply w-3.5 h-3.5 inline-flex items-center justify-center flex-shrink-0;
  }

  .function-icon svg {
    @apply w-3.5 h-3.5;
  }

  .function-call-card.expanded .function-icon {
    @apply w-[18px] h-[18px] rounded opacity-100 text-[11px];
    background: var(--color-surface-overlay);
  }

  .function-call-card.expanded .function-icon svg {
    @apply w-3.5 h-3.5;
  }

  .function-name {
    @apply font-semibold text-xs whitespace-nowrap flex-shrink-0 font-mono;
  }

  .function-call-card.expanded .function-name {
    @apply text-xs font-semibold tracking-wider flex-1 whitespace-nowrap overflow-hidden text-ellipsis font-sans;
  }

  .function-params {
    @apply font-normal text-xs whitespace-nowrap overflow-hidden text-ellipsis flex-shrink min-w-0 font-mono;
  }

  .function-call-card.expanded .function-params {
    @apply hidden;
  }

  .function-status {
    @apply hidden;
  }

  .function-call-card.expanded .function-status {
    @apply inline-flex items-center gap-1 text-[10px] font-medium lowercase py-0.5 px-1.5 rounded-md flex-shrink-0;
    background: var(--color-surface-overlay);
  }

  /* Status icon styling for WCAG 1.4.1 compliance */
  .status-icon {
    @apply inline-flex items-center justify-center flex-shrink-0;
  }

  .status-icon svg {
    @apply w-3 h-3;
  }

  .function-expand-indicator {
    @apply hidden;
  }

  .function-arguments {
    @apply hidden;
  }

  .function-call-card.expanded .function-arguments {
    @apply block border rounded-md p-1.5 px-2 mt-1.5 font-mono text-xs max-h-[120px] overflow-y-auto break-all leading-relaxed;
    background: var(--color-surface-3);
    border-color: var(--color-border-secondary);
    color: var(--color-text-on-surface);
  }

  .function-result {
    @apply hidden;
  }

  .function-call-card.expanded .function-result {
    @apply block border rounded-lg p-2.5 px-3 mt-2.5 text-xs max-h-[150px] overflow-y-auto overflow-x-hidden break-words whitespace-pre-wrap leading-relaxed font-medium;
    background: var(--color-surface-3);
    border-color: var(--color-border-secondary);
    color: var(--color-text-on-surface);
  }

  /* File items */
  .file-item {
    @apply flex items-center gap-2.5 py-2.5 px-3 border rounded-lg transition-all cursor-pointer select-none active:scale-[0.98];
    background-color: var(--color-surface-2);
    border-color: var(--color-border-secondary);
  }

  .file-item:hover {
    border-color: var(--color-border-hover);
    box-shadow: 0 0 0 3px var(--color-brand-glow);
  }

  .file-icon {
    @apply text-lg flex-shrink-0 flex items-center justify-center;
    color: var(--color-text-secondary);
  }

  .file-name {
    @apply flex-1 text-[13px] overflow-hidden text-ellipsis whitespace-nowrap font-medium;
    color: var(--color-text-primary);
  }

  .file-size {
    @apply text-[11px] flex-shrink-0;
    color: var(--color-text-secondary);
  }

  .file-delete-btn {
    @apply bg-transparent border-none cursor-pointer p-1 rounded text-sm opacity-0 flex-shrink-0;
    color: var(--color-text-secondary);
  }

  .file-delete-btn svg {
    @apply transition-colors duration-150;
  }

  .file-item:hover .file-delete-btn {
    @apply opacity-100;
  }

  .file-delete-btn:hover svg {
    color: var(--color-status-error);
  }

  /* Welcome page components */
  .welcome-container {
    @apply absolute inset-0 flex items-center justify-center z-[100];
  }

  .welcome-content {
    @apply max-w-[720px] w-full px-8 pt-8 pb-12 flex flex-col items-center gap-8 translate-y-[4vh];
  }

  .welcome-header {
    @apply flex flex-col items-center gap-4 relative;
  }

  .welcome-logo {
    @apply absolute -left-[5.5rem] top-1/2 -translate-y-1/2 w-16 h-16 rounded-2xl;
    color: var(--color-text-primary);
  }

  .welcome-greeting {
    @apply text-3xl font-medium m-0;
    color: var(--color-text-primary);
  }

  .welcome-input-section {
    @apply w-full flex flex-col gap-3 rounded-3xl py-5 px-6 transition-all;
    background-color: var(--color-surface-1);
    border: 1px solid var(--color-border-secondary);
  }

  .welcome-input-section:focus-within {
    border-color: var(--color-border-focus);
    box-shadow: 0 0 0 3px var(--color-brand-glow);
  }

  /* Compact variant for chat page - absolute minimal padding */
  .welcome-input-section.compact {
    @apply gap-0 py-1 px-2 rounded-lg;
    background-color: #191b29;
  }

  .welcome-input-footer {
    @apply grid grid-cols-[1fr_auto_auto] grid-rows-1 items-center gap-1.5 pt-2;
  }

  /* Compact variant - simplified layout, controls on right */
  .welcome-input-section.compact .welcome-input-footer {
    @apply pt-0 gap-1.5 grid-cols-[1fr_auto_auto] grid-rows-1;
  }

  /* Model selector in compact mode goes to column 2 */
  .welcome-input-section.compact .model-config-inline {
    @apply col-start-2 row-start-1;
  }

  /* Send button in compact mode goes to column 3 */
  .welcome-input-section.compact .welcome-send-btn {
    @apply col-start-3 row-start-1;
  }

  .mcp-toggle-buttons {
    @apply flex items-center gap-1.5 flex-shrink-0 col-start-1 row-start-1 row-end-3 self-center;
  }

  /* Wrapper for model selector to enable relative positioning */
  .model-config-inline {
    @apply relative flex flex-col items-end gap-1 flex-shrink-0 col-start-2 row-start-1;
  }

  .model-selector-trigger {
    @apply flex items-center gap-1.5 py-1.5 px-3 border-none rounded-lg bg-transparent text-sm font-medium cursor-pointer transition-colors;
    color: var(--color-text-secondary);
  }

  .model-selector-trigger:hover {
    background-color: var(--color-surface-hover);
    color: var(--color-text-primary);
  }

  /* Compact variant - smaller model selector trigger */
  .welcome-input-section.compact .model-selector-trigger {
    @apply py-1 px-2 text-xs;
  }

  .model-selector-trigger svg {
    @apply w-4 h-4 transition-transform;
  }

  .model-selector-dropdown {
    @apply absolute right-0 w-[300px] rounded-lg z-50 overflow-hidden;
    background-color: var(--color-surface-2);
    border: 1px solid var(--color-border-secondary);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
    top: calc(100% + 4px);
    max-height: 500px;
  }

  [data-theme="dark"] .model-selector-dropdown {
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
  }

  .model-selector-content {
    @apply p-2 overflow-y-auto;
    max-height: inherit;
  }

  .model-cards {
    @apply flex flex-col gap-1.5 mb-1.5;
  }

  .model-card-wrapper {
    @apply flex flex-col gap-0;
  }

  .model-card {
    @apply flex flex-col items-start gap-0.5 p-2.5 rounded-md bg-transparent text-left cursor-pointer transition-all;
    border: 1px solid var(--color-border-secondary);
  }

  .model-card:hover {
    border-color: var(--color-border-hover);
    background-color: var(--color-surface-hover);
  }

  .model-card.selected {
    border-color: var(--color-brand-primary);
    background-color: var(--color-surface-active);
  }

  .model-card-header {
    @apply flex items-center justify-between w-full;
  }

  .model-card-icons {
    @apply flex items-center gap-1;
  }

  .model-card-name {
    @apply text-sm font-semibold;
    color: var(--color-text-primary);
  }

  .reasoning-expand-btn {
    @apply flex items-center justify-center w-6 h-6 p-0 border-none rounded-md bg-transparent cursor-pointer transition-all;
    color: var(--color-text-secondary);
  }

  .reasoning-expand-btn:hover {
    background-color: var(--color-surface-hover);
    color: var(--color-text-primary);
  }

  .reasoning-expand-btn svg {
    @apply w-3.5 h-3.5 transition-transform;
  }

  .model-card-check {
    @apply text-transparent w-4 h-4;
  }

  .model-card.selected .model-card-check {
    color: var(--color-brand-primary);
  }

  .model-card-description {
    @apply text-xs leading-tight;
    color: var(--color-text-secondary);
  }

  .reasoning-panel {
    @apply mt-1.5 pt-1.5;
    border-top: 1px solid var(--color-border-secondary);
  }

  .reasoning-panel-content {
    @apply px-2.5 pb-1.5;
  }

  .reasoning-panel-label {
    @apply text-[10px] font-semibold mb-1.5 uppercase tracking-wider;
    color: var(--color-text-secondary);
  }

  .reasoning-options {
    @apply flex flex-col gap-1;
  }

  .reasoning-option {
    @apply flex flex-col items-start gap-0 p-1.5 rounded-md bg-transparent text-left cursor-pointer transition-all;
    border: 1px solid var(--color-border-secondary);
  }

  .reasoning-option:hover {
    border-color: var(--color-border-hover);
    background-color: var(--color-surface-hover);
  }

  .reasoning-option.selected {
    border-color: var(--color-brand-primary);
    background-color: var(--color-surface-active);
  }

  .reasoning-option-header {
    @apply flex items-center justify-between w-full;
  }

  .reasoning-option-value {
    @apply text-xs font-semibold;
    color: var(--color-text-primary);
  }

  .reasoning-option-check {
    @apply text-transparent w-3.5 h-3.5;
  }

  .reasoning-option.selected .reasoning-option-check {
    color: var(--color-brand-primary);
  }

  .reasoning-option-description {
    @apply text-[11px] leading-tight;
    color: var(--color-text-secondary);
  }

  .more-models-toggle {
    @apply flex items-center justify-between w-full py-2 px-2.5 border-none rounded-md bg-transparent text-xs font-medium cursor-pointer transition-colors;
    color: var(--color-text-secondary);
  }

  .more-models-toggle:hover {
    background-color: var(--color-surface-hover);
    color: var(--color-text-primary);
  }

  .more-models-toggle svg {
    @apply w-3.5 h-3.5 transition-transform;
  }

  .more-models-section {
    @apply flex flex-col gap-1.5 mt-1.5 pt-1.5;
    border-top: 1px solid var(--color-border-secondary);
  }

  .reasoning-selector-section {
    @apply mt-3 pt-3;
    border-top: 1px solid var(--color-border-secondary);
  }

  .reasoning-label {
    @apply text-sm font-medium mb-2;
    color: var(--color-text-primary);
  }

  .reasoning-select {
    @apply w-full py-2 px-3 rounded-lg text-sm cursor-pointer transition-colors focus:outline-none;
    background-color: var(--color-surface-1);
    border: 1px solid var(--color-border-secondary);
    color: var(--color-text-primary);
  }

  .reasoning-select:hover {
    border-color: var(--color-border-hover);
  }

  .reasoning-select:focus {
    border-color: var(--color-border-focus);
    box-shadow: 0 0 0 1px var(--color-border-focus);
  }

  .welcome-send-btn {
    @apply col-start-3 row-start-1 justify-self-end;
  }

  .mcp-toggle-btn {
    @apply flex items-center justify-center w-9 h-9 p-0 rounded-[0.65rem] cursor-pointer transition-all flex-shrink-0;
    background-color: var(--color-surface-hover);
    border: 1px solid var(--color-border-secondary);
    color: var(--color-text-secondary);
    box-shadow: inset 0 0 0 0 var(--color-brand-glow);
  }

  .mcp-toggle-btn:hover {
    border-color: var(--color-border-hover);
    background-color: var(--color-surface-active);
    color: var(--color-text-primary);
  }

  .mcp-toggle-btn.active {
    border-color: var(--color-brand-primary);
    background-color: var(--color-surface-active);
    color: var(--color-brand-primary);
    box-shadow: inset 0 0 0 1px var(--color-brand-glow);
  }

  .mcp-toggle-btn svg {
    @apply w-4 h-4;
  }

  .welcome-input {
    @apply w-full min-h-7 max-h-[200px] border-none outline-none bg-transparent text-base leading-[1.625] resize-none overflow-y-auto py-1 px-0;
    color: var(--color-text-primary);
  }

  .welcome-input::placeholder {
    color: var(--color-text-secondary);
    opacity: 0.6;
  }

  /* Compact variant - very small min height, tight text */
  .welcome-input-section.compact .welcome-input {
    @apply min-h-5 text-sm leading-[1.3] py-1.5;
    background-color: #191b29;
    color: #ffffff;
  }

  .welcome-send-btn {
    @apply flex items-center justify-center w-11 h-11 border-none rounded-full cursor-not-allowed transition-all;
    background-color: var(--color-surface-active);
    color: var(--color-text-user);
    opacity: 0.5;
    box-shadow: inset 0 0 0 0 rgba(0, 102, 204, 0.4);
  }

  /* Compact variant - very small button with equal spacing from edges */
  .welcome-input-section.compact .welcome-send-btn {
    @apply w-6 h-6 mr-1 mb-1;
  }

  .welcome-input-section.compact .welcome-send-btn svg {
    @apply w-3.5 h-3.5;
  }

  .welcome-send-btn.ready {
    @apply cursor-pointer;
    background-color: var(--color-brand-primary);
    color: var(--color-text-user);
    opacity: 1;
    box-shadow: 0 10px 20px -12px rgba(0, 102, 204, 0.7);
  }

  .welcome-send-btn.ready:hover {
    box-shadow: 0 12px 26px -16px rgba(0, 102, 204, 0.9);
    transform: translateY(-1px);
  }

  .welcome-send-btn.ready:active {
    transform: translateY(0);
    box-shadow: 0 6px 18px -12px rgba(0, 102, 204, 0.75);
  }

  [data-theme="dark"] .welcome-send-btn.ready {
    box-shadow: 0 10px 24px -14px rgba(0, 102, 204, 0.8);
  }

  [data-theme="dark"] .welcome-send-btn.ready:hover {
    box-shadow: 0 12px 28px -18px rgba(0, 102, 204, 0.9);
  }

  [data-theme="dark"] .welcome-send-btn.ready:active {
    box-shadow: 0 8px 20px -14px rgba(0, 102, 204, 0.85);
  }

  .welcome-send-btn:disabled {
    @apply opacity-100;
  }

  .suggestion-pills {
    @apply flex gap-2 flex-wrap justify-center mt-2;
  }

  .suggestion-pill {
    @apply flex items-center gap-1.5 py-2 px-3 rounded-lg bg-transparent text-sm font-[450] cursor-pointer transition-all whitespace-nowrap;
    border: 1px solid var(--color-border-secondary);
    color: var(--color-text-secondary);
  }

  .suggestion-pill:hover {
    border-color: var(--color-border-hover);
    background-color: var(--color-surface-hover);
    color: var(--color-text-primary);
  }

  .suggestion-pill:active {
    color: var(--color-text-primary);
  }

  .pill-icon {
    @apply w-4 h-4 flex items-center justify-center flex-shrink-0 opacity-50 transition-opacity;
  }

  .suggestion-pill:hover .pill-icon {
    @apply opacity-80;
  }

  .pill-icon svg {
    @apply w-4 h-4;
  }

  .model-info {
    @apply mt-4 py-2 px-4 rounded-2xl text-sm font-medium;
    background-color: var(--color-surface-1);
    color: var(--color-text-secondary);
  }

  .welcome-files-section {
    @apply mt-8 w-full max-w-[600px];
  }

  .welcome-files-header {
    @apply flex items-center justify-between mb-3 px-1;
  }

  .welcome-files-title {
    @apply text-sm font-semibold;
    color: var(--color-text-secondary);
  }

  .welcome-files-refresh-btn {
    @apply bg-none border-none p-1 cursor-pointer rounded transition-all flex items-center justify-center;
    color: var(--color-text-secondary);
  }

  .welcome-files-refresh-btn:hover {
    background-color: var(--color-surface-hover);
    color: var(--color-text-primary);
  }

  .welcome-files-list {
    @apply rounded-lg p-2 max-h-[200px] overflow-y-auto min-h-[60px];
    background-color: var(--color-surface-overlay);
    border: 1px solid var(--color-border-secondary);
  }

  .welcome-files-list:empty::before {
    @apply block text-center text-sm p-4;
    color: var(--color-text-secondary);
    content: "No files uploaded yet";
  }

  .welcome-files-list .file-item {
    @apply py-2 px-3 mb-1 last:mb-0;
  }

  .welcome-files-list .files-loading,
  .welcome-files-list .files-error,
  .welcome-files-list .files-empty {
    @apply text-center p-4 text-sm;
    color: var(--color-text-secondary);
  }

  body.view-welcome .chat-panel,
  body.view-welcome .files-panel,
  body.view-welcome #files-toggle-wrapper,
  body.view-welcome #files-panel-toggle-wrapper {
    display: none !important;
  }

  body.view-chat .welcome-container {
    display: none !important;
  }

  /* User message bubble gradient - using Tailwind best practices */
  .bg-user-gradient {
    @apply bg-gradient-to-br from-[#0066cc] to-[#0052a3];
  }

  /* Toast notifications */
  .toast {
    @apply py-3.5 px-5 rounded-xl text-sm font-medium shadow-[0_4px_12px_rgba(0,0,0,0.15)] pointer-events-auto backdrop-blur-[10px] min-w-[200px] max-w-[400px];
    word-wrap: break-word;
  }

  .animate-fadeOut {
    animation: fadeOut 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  }

  .animate-slideIn {
    animation: slideIn 0.3s ease-out;
  }

  .toast-pulse {
    animation: toast-pulse 0.2s ease-in-out;
  }

  /* ==========================================
   * MARKDOWN CONTENT STYLING
   * Too complex for inline utilities, keeps content readable
   * ========================================== */
  .message-content {
    max-width: 100%;
    font-size: 0.875rem;
    line-height: 1.5;
  }

  .message-content h1,
  .message-content h2,
  .message-content h3,
  .message-content h4,
  .message-content h5,
  .message-content h6 {
    margin-top: 0.5em;
    margin-bottom: 0.2em;
    font-weight: 600;
    line-height: 1.25;
    color: var(--color-text-primary);
  }

  .message-content h1 {
    font-size: 1.5em;
  }
  .message-content h2 {
    font-size: 1.3em;
  }
  .message-content h3 {
    font-size: 1.15em;
  }
  .message-content h4 {
    font-size: 1.05em;
  }
  .message-content h5 {
    font-size: 1em;
  }
  .message-content h6 {
    font-size: 0.95em;
  }

  .message-content p {
    margin: 0.25em 0;
    line-height: 1.4;
  }

  .message-content p + p {
    margin-top: 0.5em;
  }

  .message-content h1 + ul,
  .message-content h2 + ul,
  .message-content h3 + ul,
  .message-content h4 + ul,
  .message-content h5 + ul,
  .message-content h6 + ul,
  .message-content h1 + ol,
  .message-content h2 + ol,
  .message-content h3 + ol,
  .message-content h4 + ol,
  .message-content h5 + ol,
  .message-content h6 + ol {
    margin-top: 0.1em;
  }

  .message-content > *:first-child {
    margin-top: 0;
  }

  .message-content > *:last-child {
    margin-bottom: 0;
  }

  /* Code styling */
  .message-content code {
    background-color: var(--color-surface-overlay);
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    font-size: 0.9em;
    font-family: monospace;
    color: var(--color-text-primary);
  }

  .message-content pre:not(.mermaid) {
    background-color: var(--color-surface-overlay);
    border: 1px solid var(--color-border-secondary);
    border-radius: 0.5rem;
    padding: 0.625rem;
    overflow-x: auto;
    margin: 0.4em 0;
  }

  .message-content pre code {
    background-color: transparent;
    padding: 0;
    border-radius: 0;
    font-size: 0.85em;
    line-height: 1.5;
  }

  /* Code block with copy button */
  .message-content .code-block-wrapper {
    margin: 0.4em 0;
    display: block;
  }

  .message-content .code-block-wrapper pre {
    margin: 0;
    display: block;
    position: relative;
  }

  .message-content .code-block-wrapper .code-copy-btn {
    position: absolute;
    top: 0.75rem;
    right: 0.75rem;
    background: var(--color-surface-overlay);
    border: 1px solid var(--color-border-secondary);
    color: var(--color-text-primary);
    cursor: pointer;
    padding: 0.375rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 0.375rem;
    transition: all 0.15s ease;
    opacity: 0;
    z-index: 1000;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  }

  .message-content .code-block-wrapper:hover .code-copy-btn {
    opacity: 1;
  }

  .message-content .code-copy-btn:hover {
    background-color: var(--color-surface-hover);
    color: var(--color-text-primary);
    transform: scale(1.05);
  }

  .message-content .code-copy-btn.copied {
    color: var(--color-status-success);
    opacity: 1;
  }

  .message-content .code-copy-btn svg {
    width: 16px;
    height: 16px;
    stroke-width: 2;
  }

  /* Lists */
  .message-content ul {
    margin: 0.15em 0;
    padding-left: 1.5rem;
    line-height: 1.35;
    list-style-type: disc;
    list-style-position: outside;
  }

  .message-content ol {
    margin: 0.15em 0;
    padding-left: 1.5rem;
    line-height: 1.35;
    list-style-type: decimal;
    list-style-position: outside;
  }

  .message-content ul ul {
    list-style-type: circle;
    margin: 0 0 0.02em 0;
  }

  .message-content ul ul ul {
    list-style-type: square;
    margin: 0 0 0.02em 0;
  }

  .message-content ol ol {
    list-style-type: lower-alpha;
    margin: 0 0 0.02em 0;
  }

  .message-content ol ol ol {
    list-style-type: lower-roman;
    margin: 0 0 0.02em 0;
  }

  .message-content ol ul,
  .message-content ul ol {
    margin: 0 0 0.02em 0;
  }

  .message-content li {
    margin: 0.02em 0;
    padding-left: 0.2em;
    display: list-item;
  }

  .message-content li li {
    margin: 0.01em 0;
  }

  .message-content li > ul,
  .message-content li > ol {
    margin: 0 0 0.02em 0;
    margin-top: 0;
  }

  /* Blockquotes */
  .message-content blockquote {
    border-left: 3px solid var(--color-border-primary);
    margin: 0.4em 0;
    padding: 0.4em 0.8em;
    background-color: var(--color-surface-overlay);
    font-style: italic;
    color: var(--color-text-secondary);
  }

  /* Links */
  .message-content a {
    color: var(--color-brand-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color 150ms;
  }

  .message-content a:hover {
    border-bottom-color: var(--color-brand-primary);
  }

  /* Tables */
  .message-content table {
    border-collapse: collapse;
    width: 100%;
    margin: 0.4em 0;
    font-size: 0.9em;
  }

  .message-content th,
  .message-content td {
    border: 1px solid var(--color-border-secondary);
    padding: 0.5rem 0.75rem;
    text-align: left;
  }

  .message-content th {
    background-color: var(--color-surface-overlay);
    font-weight: 600;
  }

  /* Images */
  .message-content img {
    max-width: 100%;
    height: auto;
    border-radius: 0.5rem;
    margin: 0.5em 0;
    box-shadow: 0 1px 3px var(--color-surface-overlay);
  }

  /* Horizontal rule */
  .message-content hr {
    border: 0;
    border-top: 1px solid var(--color-border-secondary);
    margin: 0.4em 0;
  }

  /* Strong/bold text */
  .message-content strong {
    font-weight: 600;
    color: var(--color-text-primary);
  }

  /* Task lists (checkboxes) */
  .message-content input[type="checkbox"] {
    margin-right: 0.5em;
    vertical-align: middle;
    cursor: default;
  }

  .message-content li:has(> input[type="checkbox"]) {
    list-style-type: none;
    margin-left: -1.5rem;
  }

  /* Mermaid diagrams */
  .message-content .mermaid-wrapper {
    margin: 0.5rem 0;
    padding: 1rem;
    background-color: var(--color-surface-1);
    border: 1px solid var(--color-border-secondary);
    border-radius: 0.5rem;
    overflow-x: auto;
    min-height: 100px;
  }

  .message-content .mermaid-wrapper svg {
    display: block;
    max-width: 100%;
    height: auto;
  }

  /* Spacing adjustments for different content combinations */
  .message-content p + ul,
  .message-content p + ol {
    margin-top: 0.25em;
  }

  .message-content ul + p,
  .message-content ol + p {
    margin-top: 0.25em;
  }

  .message-content li pre {
    margin-top: 0.2em;
    margin-bottom: 0.2em;
  }

  .message-content li > pre:first-child {
    margin-top: 0.1em;
  }

  .message-content li p + pre {
    margin-top: 0.15em;
  }

  .message-content p + pre {
    margin-top: 0.3em;
  }

  .message-content pre + p {
    margin-top: 0.3em;
  }

  .message-content h1 + pre,
  .message-content h2 + pre,
  .message-content h3 + pre,
  .message-content h4 + pre,
  .message-content h5 + pre,
  .message-content h6 + pre {
    margin-top: 0.2em;
  }
}

/* Base styles */
@layer base {
  :root {
    /* ========================================
     * SURFACE COLORS - Light Mode
     * ======================================== */
    --color-surface-1: #f8f8f6;
    --color-surface-2: #ffffff;
    --color-surface-3: #f8f8f6;
    --color-surface-overlay: rgba(0, 0, 0, 0.05);
    --color-surface-hover: rgba(0, 0, 0, 0.03);
    --color-surface-active: rgba(37, 99, 235, 0.08);

    /* ========================================
     * TEXT COLORS - Light Mode
     * ======================================== */
    --color-text-primary: #1a1a1a;
    --color-text-secondary: #6b7280;
    --color-text-assistant: #191b29;
    --color-text-user: #ffffff;
    --color-text-on-surface: #374151;

    /* ========================================
     * BORDER COLORS - Light Mode
     * ======================================== */
    --color-border-primary: #6b7280;
    --color-border-secondary: #d1d5db;
    --color-border-focus: #0066cc;
    --color-border-hover: #0066cc;

    /* ========================================
     * BRAND COLORS (Same for both modes)
     * ======================================== */
    --color-brand-primary: #0066cc;
    --color-brand-secondary: #0052a3;
    --color-brand-gradient: linear-gradient(135deg, #0066cc 0%, #0052a3 100%);
    --color-brand-glow: rgba(0, 102, 204, 0.2);  /* Brand blue at 20% for focus/hover glows */

    /* ========================================
     * STATUS COLORS (Same for both modes)
     * ======================================== */
    --color-status-info: #3b82f6;
    --color-status-success: #10b981;
    --color-status-warning: #f59e0b;
    --color-status-error: #ef4444;

    /* ========================================
     * FUNCTION CALL STATES (Same for both modes)
     * ======================================== */
    --color-function-executing: linear-gradient(135deg, #0066cc 0%, #0052a3 100%);
    --color-function-success: linear-gradient(135deg, #059669 0%, #10b981 100%);
    --color-function-error: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);

    /* ========================================
     * SCROLLBAR COLORS - Light Mode
     * ======================================== */
    --color-scrollbar-thumb: #e5e7eb;
    --color-scrollbar-thumb-hover: #6b7280;

    /* ========================================
     * OVERLAYS - Light Mode
     * ======================================== */
    --color-overlay-backdrop: rgba(0, 0, 0, 0.5);
  }

  [data-theme="dark"] {
    /* ========================================
     * SURFACE COLORS - Dark Mode
     * ======================================== */
    --color-surface-1: #141622;
    --color-surface-2: #191b29;
    --color-surface-3: #1e2432;
    --color-surface-overlay: rgba(255, 255, 255, 0.05);
    --color-surface-hover: rgba(255, 255, 255, 0.03);
    --color-surface-active: rgba(37, 99, 235, 0.12);

    /* ========================================
     * TEXT COLORS - Dark Mode
     * ======================================== */
    --color-text-primary: #f5f5f5;
    --color-text-secondary: #a0a0a0;
    --color-text-assistant: #f1f5f9;
    --color-text-on-surface: #d1d5db;

    /* ========================================
     * BORDER COLORS - Dark Mode (WCAG AA compliant)
     * ======================================== */
    --color-border-primary: #6b7280;    /* Lightened from #374151 for 3:1 contrast */
    --color-border-secondary: #6b7280;  /* Unified with primary for consistency */
    --color-border-focus: #0066cc;      /* Brand blue for consistency */

    /* ========================================
     * SCROLLBAR COLORS - Dark Mode
     * ======================================== */
    --color-scrollbar-thumb: #333333;
    --color-scrollbar-thumb-hover: #a0a0a0;

    /* ========================================
     * OVERLAYS - Dark Mode
     * ======================================== */
    --color-overlay-backdrop: rgba(0, 0, 0, 0.9);
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    height: 100vh;
    margin: 0;
    padding: 0;
    overflow: hidden;
    transition: all 300ms;
  }

  /* Background colors for welcome vs chat view */
  body.view-welcome {
    background: #f8f8f6;
  }

  body.view-chat {
    background: white;
  }

  [data-theme="dark"] body.view-welcome {
    background: #191b29;
  }

  [data-theme="dark"] body.view-chat {
    background: #191b29;
  }

  /* Placeholder text for empty states */
  .files-loading,
  .files-empty,
  .sessions-loading {
    @apply p-4 text-center text-sm text-gray-600;
  }

  .files-empty svg {
    @apply inline-block;
  }

  .files-error {
    @apply p-4 text-center text-sm text-red-500;
  }

  [data-theme="dark"] .files-error {
    @apply text-red-400;
  }
}
